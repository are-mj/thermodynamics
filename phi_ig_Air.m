function res = phi_ig_Air(tau,delta,par,max_order)
% Ideal gas part of Helmholtz free energy (J/kmol)
% Ref: Lemmon,  E.W.;  Jacobsen,  R.T.;  Penoncello,  S.G.;  Friend,  D.G. 
% Thermodynamic  properties  of  air  and  mixtures  of  nitrogen,  argon, 
% and oxygen from 60 to 2000 K at pressures to 2000 MPa. 
% J. Phys. Chem. Ref. Data. 2000, 29, 331. 
% Equation 24 and Table 12
  N = par.ig_a;
  alpha = exp(-N(11:13)*tau);
  phi = log(delta) + tau.^[-3:1,1.5]*N(1:6)+N(7)*log(tau) ...
    + N(8:9)'*log(1-alpha(1:2)) + N(10)*log(2/3+alpha(3)^-1);
  phi_t = [-3:1,1.5].*N(1:6)'*tau.^([-3:1,1.5]-1)' + N(7)*tau^-1 ...
    + N(8)*N(11)*alpha(1)/(1-alpha(1)) ...
    + N(9)*N(12)*alpha(2)/(1-alpha(2)) ...
    + N(10)*N(13)/(2/3*exp(-N(13)*tau)+1);
  phi_tt = [12,6,2].*N(1:3)'*tau.^[-5,-4,-3]' ...
    + 0.75*N(6)*tau^-0.5 -N(7)*tau^-2 ...
    - N(8)*N(11)^2*alpha(1)/(1-alpha(1))^2 ...
    - N(9)*N(12)^2*alpha(2)/(1-alpha(2))^2 ...
    + N(10)*N(13)^2*6*alpha(3)/(3+2*alpha(3))^2;
  phi_d = 1/delta;
  phi_dd = -1/delta^2;
  res = [phi,phi_t,phi_d,phi_tt,0,phi_dd];
  if max_order > 2
    phi_ttt = -[60 24 6].*N(1:3)'*tau.^[-6,-5,-4]' ...
    - 0.375*N(6)*tau^-1.5 +2*N(7)*tau^-3 ...
    + N(8)*N(11)^3*alpha(1)*(1+alpha(1))/(1-alpha(1))^3 ...
    + N(9)*N(12)^3*alpha(2)*(1+alpha(2))/(1-alpha(2))^3 ...
    - N(10)*N(13)^3*6*alpha(3)*(3-2*alpha(3))/(3+2*alpha(3))^3;
    phi_ddd = 2*delta^-3;
    res = [res,phi_ttt,0,0,phi_ddd];
  end
end